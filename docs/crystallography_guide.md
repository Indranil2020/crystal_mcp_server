# Crystallography Reference Guide

This document provides essential crystallography concepts for users of the Crystal Structure Generator MCP server.

## Table of Contents
1. [Space Groups](#space-groups)
2. [Wyckoff Positions](#wyckoff-positions)
3. [Lattice Parameters](#lattice-parameters)
4. [Strain Tensors](#strain-tensors)
5. [Symmetry Analysis](#symmetry-analysis)
6. [References](#references)

---

## Space Groups

### Overview
Space groups describe the complete symmetry of a crystal structure, combining:
- Point group symmetry (rotations, reflections, inversions)
- Translational symmetry (lattice periodicity)
- Screw axes and glide planes

There are **230 unique space groups** in 3D, numbered 1-230.

### Crystal Systems and Space Group Ranges

| Crystal System | Space Groups | Lattice Constraints |
|----------------|--------------|---------------------|
| Triclinic | 1-2 | a ≠ b ≠ c; α ≠ β ≠ γ |
| Monoclinic | 3-15 | a ≠ b ≠ c; α = γ = 90°, β ≠ 90° |
| Orthorhombic | 16-74 | a ≠ b ≠ c; α = β = γ = 90° |
| Tetragonal | 75-142 | a = b ≠ c; α = β = γ = 90° |
| Trigonal | 143-167 | a = b = c; α = β = γ ≠ 90° (rhombohedral) |
| Hexagonal | 168-194 | a = b ≠ c; α = β = 90°, γ = 120° |
| Cubic | 195-230 | a = b = c; α = β = γ = 90° |

### Common Space Groups for Materials

| Space Group | Symbol | Common Materials |
|-------------|--------|------------------|
| 225 | Fm-3m | NaCl (rocksalt), Cu, Au, Ag, MgO |
| 227 | Fd-3m | Diamond, Si, Ge, spinel |
| 221 | Pm-3m | CsCl, SrTiO3, BaTiO3 (perovskite) |
| 229 | Im-3m | bcc Fe, W, Mo, Cr |
| 216 | F-43m | GaAs, ZnS (zincblende) |
| 194 | P6₃/mmc | Mg (hcp), graphite, MoS2 |
| 186 | P6₃mc | ZnO, GaN, AlN (wurtzite) |
| 136 | P4₂/mnm | TiO2, SnO2 (rutile) |
| 62 | Pnma | GdFeO3 (perovskite distorted), SnSe |

---

## Wyckoff Positions

### What are Wyckoff Positions?
Wyckoff positions are sets of symmetry-equivalent atomic sites within a unit cell. Each position is characterized by:
- **Multiplicity**: Number of equivalent sites generated by symmetry
- **Letter**: Alphabetical label (a, b, c, ...)
- **Site symmetry**: Point group symmetry at that position
- **Coordinates**: Fractional coordinates (may include free parameters x, y, z)

### Notation
Wyckoff positions are written as `multiplicity + letter`, e.g.:
- `4a` = 4 equivalent sites at position 'a'
- `8c` = 8 equivalent sites at position 'c'
- `24d` = 24 equivalent sites at position 'd'

### Example: Space Group 225 (Fm-3m, Rocksalt)
```
Position | Multiplicity | Coordinates
---------|--------------|-------------
4a       | 4            | (0, 0, 0)
4b       | 4            | (1/2, 1/2, 1/2)
8c       | 8            | (1/4, 1/4, 1/4)
24d      | 24           | (0, 1/4, 1/4)
...
```

For NaCl:
- Na atoms occupy 4a positions: (0, 0, 0)
- Cl atoms occupy 4b positions: (1/2, 1/2, 1/2)

### Using Wyckoff Positions in the API
```json
{
  "wyckoff_positions": [
    {"element": "Na", "wyckoff": "4a"},
    {"element": "Cl", "wyckoff": "4b"}
  ]
}
```

You can optionally specify coordinates for general positions:
```json
{
  "wyckoff_positions": [
    {"element": "O", "wyckoff": "48h", "coords": [0.25, 0.25, 0.25]}
  ]
}
```

---

## Lattice Parameters

### Definition
The lattice is defined by six parameters:
- **a, b, c**: Lattice vector lengths in Angstroms (Å)
- **α (alpha)**: Angle between b and c vectors (degrees)
- **β (beta)**: Angle between a and c vectors (degrees)
- **γ (gamma)**: Angle between a and b vectors (degrees)

### Units
All distances in this server are in **Angstroms (Å)** where 1 Å = 10⁻¹⁰ m = 0.1 nm.

### Typical Lattice Parameters

| Material | a (Å) | b (Å) | c (Å) | Structure |
|----------|-------|-------|-------|-----------|
| Si | 5.431 | 5.431 | 5.431 | Diamond cubic |
| NaCl | 5.640 | 5.640 | 5.640 | Rocksalt |
| GaAs | 5.653 | 5.653 | 5.653 | Zincblende |
| Graphite | 2.46 | 2.46 | 6.71 | Hexagonal |
| TiO2 (rutile) | 4.594 | 4.594 | 2.959 | Tetragonal |
| Al2O3 | 4.759 | 4.759 | 12.99 | Trigonal |

### Lattice Matrix
The lattice can also be specified as a 3×3 matrix where rows are lattice vectors:
```
[a_x, a_y, a_z]
[b_x, b_y, b_z]
[c_x, c_y, c_z]
```

### Reciprocal Lattice
The reciprocal lattice vectors (b₁, b₂, b₃) are related to direct lattice vectors by:
- b₁ = 2π(a₂ × a₃) / V
- b₂ = 2π(a₃ × a₁) / V
- b₃ = 2π(a₁ × a₂) / V

where V is the unit cell volume.

---

## Strain Tensors

### Definition
The strain tensor ε describes deformation of a crystal:
```
ε = | ε_xx  ε_xy  ε_xz |
    | ε_yx  ε_yy  ε_yz |
    | ε_zx  ε_zy  ε_zz |
```

### Components
- **Diagonal elements** (ε_xx, ε_yy, ε_zz): Normal strains (elongation/compression)
- **Off-diagonal elements**: Shear strains

### Strain Types

| Type | Tensor Form | Description |
|------|-------------|-------------|
| Hydrostatic | ε·I₃ (isotropic) | Equal strain in all directions |
| Uniaxial | ε along one axis | Strain along single direction |
| Biaxial | ε in two axes | Strain in a plane (common for thin films) |
| Shear | Off-diagonal only | Shape distortion without volume change |

### Strain Values and Physical Limits
- **Small strain**: < 1% (0.01) - linear elastic regime
- **Moderate strain**: 1-5% (0.01-0.05) - may approach yield
- **Large strain**: 5-10% (0.05-0.10) - plastic deformation likely
- **Extreme strain**: > 10% - typically unphysical for bulk materials

**Note**: The server limits strain to < 50% and warns for strains > 5%.

### Deformation Matrix
The applied deformation is: F = I + ε

New lattice vectors: a' = F · a

### Using Strain in the API

Simple strain types:
```json
{
  "strain_type": "biaxial",
  "strain_value": 0.02
}
```

Custom strain tensor:
```json
{
  "strain_tensor": [
    [0.02, 0.0, 0.0],
    [0.0, 0.02, 0.0],
    [0.0, 0.0, -0.01]
  ]
}
```

---

## Symmetry Analysis

### Symmetry Precision (symprec)
The `symprec` parameter controls how strictly symmetry is detected:
- **Default**: 0.01 Å - suitable for most relaxed structures
- **Tight**: 0.001 Å - for high-precision experimental structures
- **Loose**: 0.1 Å - for structures with thermal disorder or defects

### Angle Tolerance
The `angle_tolerance` parameter (default: 5°) controls how much angular deviation is allowed when detecting symmetry.

### Why Adjust Tolerances?
- **DFT-relaxed structures** may have small numerical deviations
- **Experimental structures** may have measurement uncertainty
- **Defected structures** break strict symmetry

### Symmetry Detection Output
The server returns:
- **Space group number and symbol**
- **Point group**
- **Crystal system**
- **Hall symbol** (unambiguous notation)
- **Wyckoff positions** of atoms

---

## References

### Crystallography
1. International Tables for Crystallography, Vol. A: Space-group symmetry
   - https://it.iucr.org/
2. Bilbao Crystallographic Server
   - https://www.cryst.ehu.es/

### Space Groups
3. Space Group Visualizer
   - https://www.cryst.ehu.es/cryst/get_wp.html

### Wyckoff Positions
4. Wyckoff Position Database
   - https://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-wp-list

### Software References
5. Spglib - Symmetry analysis library
   - https://spglib.readthedocs.io/
6. PyXtal - Crystal structure generation
   - https://pyxtal.readthedocs.io/
7. Pymatgen - Python Materials Genomics
   - https://pymatgen.org/

### Strain and Deformation
8. Nye, J.F. "Physical Properties of Crystals" (Oxford, 1985)
9. Landau & Lifshitz, "Theory of Elasticity"

---

## Appendix: Common Element Radii

| Element | Covalent Radius (Å) | Ionic Radius (Å) |
|---------|---------------------|------------------|
| H | 0.31 | - |
| C | 0.76 | - |
| N | 0.71 | 1.46 (N³⁻) |
| O | 0.66 | 1.40 (O²⁻) |
| Si | 1.11 | 0.40 (Si⁴⁺) |
| Fe | 1.32 | 0.65 (Fe³⁺) |
| Na | 1.66 | 1.02 (Na⁺) |
| Cl | 1.02 | 1.81 (Cl⁻) |

These radii are used for distance validation and packing fraction calculations.
